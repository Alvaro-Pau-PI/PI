SA.3 IteraciÃ³: Backend Laravel + API base (per a Sprint 4)Â¶
En aquest sprint fem el salt de la versiÃ³ PHP + JSON Server (v1, que es mantÃ© intacta a legacy-php/) a una versiÃ³ mÃ©s professional amb Laravel (v2) dins la carpeta laravel/. Lâ€™objectiu Ã©s construir el backend mÃ­nim viable sobre MySQL, sense perdre el treball anterior, i deixar una API REST base preparada per al Sprint 4.

Ã‰s el primer contacte â€œseriÃ³sâ€ amb un framework gran. Partirem del catÃ leg i usuaris del sprint anterior, els migrarem a MySQL via Eloquent i deixarem preparat el terreny per al futur client SPA (Vue) i per al microservei Node.js que compartirÃ  la mateixa base de dades.

ğŸ¯ Objectius dâ€™aprenentatge (DWES Â· DIW Â· DAW)Â¶
Entendre i configurar un projecte Laravel amb .env, migracions i Eloquent (DWES).
Aplicar bones prÃ ctiques MVC i rutes en un framework PHP modern (DAW).
Integrar autenticaciÃ³ Laravel Breeze i comparar-la amb lâ€™autenticaciÃ³ manual de PHP (DWES/Seguretat).
Automatitzar la importaciÃ³ dâ€™Excel a base de dades des de Laravel, validant formats i camps (DWES).
Definir i exposar una API REST base per a productes, pensada per a ser consumida en Sprint 4 (DWES/DWEC).
Permetre la gestiÃ³ de productes importats (llistat i ediciÃ³) nomÃ©s per a administradors autenticats (DWES/Seguretat).
Realitzar proves bÃ siques (artisan test o proves manuals guiades) per validar API i imports (DWES RA8.g).
ğŸŒ RelaciÃ³ amb el projecte integradorÂ¶
Aquest sprint correspon a la IteraciÃ³ 3 (backend Laravel + API base + proves) de lâ€™enunciat global (docs/projecte.md).
Es mantÃ© tota la v1 dins legacy-php/ (PHP + JSON Server + front antic). No es toca.
Es crea laravel/ amb el backend v2 professional. docker-compose.yml es pot ampliar per incloure servei PHP-FPM + Nginx/Apache compartint MySQL amb la resta de serveis.
MySQL serÃ  la BBDD comuna per a Laravel i, en sprints futurs, per al microservei Node.js (estadÃ­stiques/recomanacions amb Swagger).
La part client dels sprints 1 i 2 es versiona com a legacy; en aquest sprint el focus Ã©s el backend i lâ€™API que consumiran els clients del Sprint 4.
ğŸ§© Tasques / HistÃ²ries dâ€™usuariÂ¶
C1 â€“ CreaciÃ³ del projecte Laravel i configuraciÃ³ de lâ€™entornÂ¶
Context: Cal un esquelet Laravel operatiu dins del repositori Ãºnic.

QuÃ¨ fer

Crear la carpeta laravel/ i inicialitzar el projecte amb Laravel (instalÂ·laciÃ³ habitual via Composer, sense copiar el comando al guiÃ³).
Configurar .env per a MySQL (mateixa instÃ ncia que legacy) i generar la clau dâ€™aplicaciÃ³.
Revisar lâ€™stack de contenidors existent del landing: si ja tens docker-compose.yml per al front, mantÃ­nâ€‘lo intacte i decideix si Laravel compartirÃ  la BBDD via eixe compose o si arrencarÃ  el seu propi docker-compose.yml amb Sail dins laravel/. Documenta lâ€™opciÃ³ escollida perÃ² no facilites el comando literal.
Fitxers clau: laravel/.env, laravel/config/database.php, docker-compose.yml, possibles docker/Dockerfile o docker/nginx.conf.

C2 â€“ Model de dades i migracions (products, users)Â¶
Context: Traslladem lâ€™esquema de products.json i users.json a MySQL amb migracions.

QuÃ¨ fer

Crear migraciÃ³ i model Product (via generator de Laravel). Camps inspirats en products.json: sku, name, description, price, stock, image, category, timestamps. Afegir Ã­ndex Ãºnic per sku.
Reutilitzar la migraciÃ³ dâ€™usuaris per defecte de Laravel (users), adaptant nomÃ©s si calen camps extra bÃ sics (telÃ¨fon, rol, etc. opcional).
Executar migracions contra la BBDD MySQL del docker-compose que hages triat (el de legacy o el de Sail).
Afegir database/seeders/ProductSeeder amb uns quants productes de prova per validar lâ€™API.
Fitxers clau: laravel/database/migrations/create_products_table.php, laravel/app/Models/Product.php, laravel/database/seeders/*, laravel/database/factories/ProductFactory.php (si es vol fer proves).

C3 â€“ AutenticaciÃ³ amb Laravel BreezeÂ¶
Context: SubstituÃ¯m lâ€™autenticaciÃ³ manual en PHP per una soluciÃ³ integrada.

QuÃ¨ fer

InstalÂ·lar Breeze i escollir versiÃ³ Blade (no SPA encara).
Compilar assets amb lâ€™eina que pertoque (npm, Vite) si cal, sense indicar el comando literal.
Verificar rutes /register i /login funcionals amb usuaris guardats en MySQL (hash per defecte).
Comparar en una nota breu (README) el flux Breeze vs. autenticaciÃ³ manual del Sprint 2 (cookies/sessions vs. middleware + Eloquent).
Fitxers clau: laravel/routes/web.php, laravel/resources/views/auth/*, laravel/app/Models/User.php, laravel/app/Http/Middleware/*.

C4 â€“ ImportaciÃ³ dâ€™Excel a la BBDD (command o controlador)Â¶
Context: Reaprofitem el flux dâ€™Excel del Sprint 2 perÃ² ara tot va directament a MySQL via Laravel.

QuÃ¨ fer

Afegir dependÃ¨ncia per gestionar Excel (Laravel-Excel o PhpSpreadsheet, sense llistar el comando).
Crear un command o un controlador amb formulari dâ€™upload que llija lâ€™Excel i inserisca/actualitze productes.
Validar camps obligatoris (sku, name, price, stock) i formats numÃ¨rics. Gestionar errors amigables.
Desar imatge o ruta dâ€™imatge segons dades disponibles (no cal pujar arxius encara).
Registrar logs/resums dâ€™importaciÃ³ (nombre de lÃ­nies, errors) i mostrar feedback en terminal o vista.
Fitxers clau: laravel/app/Console/Commands/ImportProducts.php o laravel/app/Http/Controllers/ProductImportController.php, laravel/routes/web.php (ruta dâ€™upload opcional), laravel/app/Imports/* si sâ€™usa Laravel-Excel.

C5 â€“ API base de productes per al Sprint 4Â¶
Context: Necessitem una API mÃ­nima perÃ² sÃ²lida que puga consumir la SPA del Sprint 4.

QuÃ¨ fer

Exposar una ruta GET /api/products a routes/api.php que retorne JSON de productes (sense auth).
Afegir GET /api/products/{id} i, si Ã©s viable, GET /api/products?category=...&q=... amb filtres bÃ sics i paginaciÃ³.
Utilitzar Resources (p. ex. ProductResource) per normalitzar la resposta JSON (preus, stock, timestamps).
Afegir un text al README indicant que en el Sprint 4 la SPA Vue consumirÃ  aquesta API.
Fitxers clau: laravel/routes/api.php, laravel/app/Http/Controllers/ProductController.php, laravel/app/Http/Resources/ProductResource.php, laravel/routes/web.php (si es fa la vista), laravel/resources/views/productes/index.blade.php (si es fa la vista).

C6 â€“ CRUD dâ€™administraciÃ³ de productes importats (web)Â¶
Context: Cal que els productes importats es puguen veure i modificar per a manteniment intern, nomÃ©s per administradors autenticats.

QuÃ¨ fer

Crear rutes dâ€™administraciÃ³ (web) per llistar i editar productes importats (CRUD mÃ­nim: index, edit, update).
Restringir lâ€™accÃ©s a usuaris autenticats amb rol dâ€™administrador (middleware, policy o gate).
Vista dâ€™admin amb taula/llistat i formulari dâ€™ediciÃ³ senzill (sense JS).
Afegir una nota al README indicant lâ€™accÃ©s restringit a administradors.
Fitxers clau: laravel/routes/web.php, laravel/app/Http/Controllers/Admin/ProductAdminController.php (o similar), laravel/resources/views/admin/products/*, laravel/app/Http/Middleware/* o laravel/app/Policies/*.

C7 â€“ Proves bÃ siques amb LaravelÂ¶
Context: Validar lâ€™API construÃ¯da (productes) i lâ€™accÃ©s dâ€™administraciÃ³ amb tests automatitzats de Laravel. Lâ€™autenticaciÃ³ Breeze es dona per fiable (no cal testejar-la).

QuÃ¨ fer

Tests dâ€™API productes: GET /api/products i GET /api/products/{id} (200 i estructura bÃ sica); si hi ha filtres o paginaciÃ³, cobrir-ho amb casos simples.
Tests dâ€™accÃ©s admin: comprovar que el llistat/ediciÃ³ de productes importats estÃ  restringit (403 per a no admins).
Prova dâ€™importaciÃ³: test de command/controlador dâ€™Excel amb fixture mÃ­nima si es pot; si no, documentar checklist manual.
Documentar resultats: llistar quÃ¨ sâ€™ha provat, dades utilitzades i estat (passa/falla) per adjuntar a evidÃ¨ncies.
Fitxers clau: laravel/tests/Feature/* (productes), laravel/tests/ en general, arxius de fixtures dâ€™Excel si sâ€™usen.

ğŸ“¦ Entregables del sprintÂ¶
Codi Laravel dins laravel/ amb migracions, models, rutes (web i API) i autenticaciÃ³ Breeze funcional.
Infraestructura docker clarificada: si continues amb el compose del landing, deixaâ€‘l intacte i documenta com Laravel sâ€™hi connecta; si uses el docker-compose.yml de Sail dins laravel/, indica com conviu amb el stack existent.
DocumentaciÃ³ mÃ­nima al README.md: nova arquitectura (carpetes legacy-php/ + laravel/), instruccions de posada en marxa i operacions bÃ siques (migracions, arrencar el servei, importaciÃ³ dâ€™Excel) explicades sense donar el comando literal, i nota de comparaciÃ³ Breeze vs. auth manual.
Vista/CRUD dâ€™administraciÃ³ de productes importats amb accÃ©s restringit a administradors.
EvidÃ¨ncia de proves: tests Laravel sobre API de productes i checklist manual nomÃ©s si cal per a la importaciÃ³.
EvidÃ¨ncia de planificaciÃ³ i execuciÃ³ (tauler, Gantt o checklist) per cobrir els RA3 i RA4 del mÃ²dul de projecte.
âœ… Criteris dâ€™avaluaciÃ³Â¶
Laravel core: migracions correctes, models Eloquent, rutes i controladors nets.
AutenticaciÃ³: Breeze operatiu (registre/login/logout), usuaris guardats en MySQL amb hash.
ImportaciÃ³ Excel: cÃ rrega a products amb validacions i gestiÃ³ dâ€™errors (no es trenquen dades).
GestiÃ³ de productes: llistat i ediciÃ³ accessibles nomÃ©s per administradors autenticats.
Qualitat de codi: nomenclatura clara, arxius en la carpeta adequada, comentaris mÃ­nims i Ãºtils, README actualitzat.
IntegraciÃ³: legacy-php/ preservat; nova API /api/products disponible per a futurs consums.
Proves: tests Laravel sobre API de productes; checklist manual nomÃ©s si la importaciÃ³ no tÃ© test.
GestiÃ³ de projecte (RA3 i RA4): planificaciÃ³ i execuciÃ³ evidenciades (tasques/cronograma, seguiment dâ€™estat, revisiÃ³ final).
ğŸ”­ Connexions amb sprints futursÂ¶
Sprint 4: construirem una SPA amb Vue que consumirÃ  lâ€™API Laravel (/api/products i nous endpoints) amb gestiÃ³ de rols/permisos.
Sprint 5+: desenvoluparem un microservei Node.js per a estadÃ­stiques i recomanacions sobre la mateixa BBDD MySQL, documentat amb Swagger, i integrarem processos asÃ­ncrons.
